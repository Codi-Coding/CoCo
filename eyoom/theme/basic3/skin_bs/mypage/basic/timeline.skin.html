<?php if (!defined("_GNUBOARD_")) exit;
add_stylesheet('<link rel="stylesheet" href="../../../plugins/slick/slick.min.css" type="text/css" media="screen">',0);
?>

<style>
.my-timeline .float-none {float:none !important}
.my-timeline .timeline {position:relative;padding:20px 0;list-style:none;background:#fff}
.my-timeline .timeline:before {top:0;bottom:0;position:absolute;content:"";width:1px;background-color:#eee;left:50%;margin-left:-1px}
.my-timeline .timeline > li {margin-bottom:40px;position:relative;width:50%;float:left;clear:left}
.my-timeline .timeline > li:before,.my-timeline .timeline > li:after {content:"";display:table}
.my-timeline .timeline > li:after {clear:both}
.my-timeline .timeline > li:before,.my-timeline .timeline > li:after {content: "";display:table}
.my-timeline .timeline > li:after {clear:both}
.my-timeline .timeline > li > .timeline-panel {position:relative;width:94%;float:left;border:1px solid #e5e5e5;border-radius:2px !important}
.my-timeline .timeline > li > .timeline-panel:before {position: absolute;top:33px;right:-8px;display:inline-block;border-top:8px solid transparent;border-left:8px solid #e5e5e5;border-right:0 solid #ddd;border-bottom:8px solid transparent;content:""}
.my-timeline .timeline > li > .timeline-panel:after {position:absolute;top:34px;right:-7px;display:inline-block;border-top:7px solid transparent;border-left:7px solid #fafafa;border-right:0 solid #fafafa;border-bottom:7px solid transparent;content:""}
.my-timeline .timeline > li > .timeline-badge {color:#c5c5c5;width:24px;height:24px;line-height:50px;font-size:20px;cursor:pointer;text-align:center;position:absolute;top:18px;right:-11px;z-index:9}
.my-timeline .timeline > li > .timeline-badge i:hover {color:#474A5E}
.my-timeline .timeline > li.timeline-inverted > .timeline-panel {float:right}
.my-timeline .timeline > li.timeline-inverted > .timeline-panel:before {border-left-width:0;border-right-width:8px;left:-8px;right:auto}
.my-timeline .timeline > li.timeline-inverted > .timeline-panel:after {border-left-width:0;border-right-width:7px;left:-7px;right:auto}
.my-timeline .timeline > li.timeline-inverted {float:right;clear:right;margin-top:40px;margin-bottom:0}
.my-timeline .timeline > li.timeline-inverted > .timeline-badge {left:-12px}
.my-timeline .timeline > li > .timeline-panel .timeline-heading {position:relative;overflow:hidden;display:block;padding:0 15px;background:#fafafa;border-radius:2px 2px 0 0 !important}
.my-timeline .timeline > li > .timeline-panel .timeline-heading .timeline-img {position:relative;overflow:hidden;max-height:180px;margin-top:15px}
.my-timeline .timeline > li > .timeline-panel .timeline-heading .timeline-img img {width:100%}
.my-timeline .timeline > li > .timeline-panel .timeline-top {padding:15px;background:#fafafa}
.my-timeline .timeline > li > .timeline-panel .timeline-body {padding:0 15px 15px;background:#fafafa}
.my-timeline .timeline > li > .timeline-panel .timeline-body h5 {font-size:15px;display:block;font-weight:bold;margin:0 0 15px}
.my-timeline .timeline > li > .timeline-panel .timeline-body p {margin-bottom:0}
.my-timeline .timeline > li > .timeline-panel .timeline-body span {color:#888;font-size:12px}
.my-timeline .timeline > li > .timeline-panel .timeline-footer {padding:10px 15px;overflow:hidden;border-top:1px solid #e5e5e5;font-size:12px;color:#959595}
@media (max-width: 991px) {
	.my-timeline .timeline:before {left:11px}
	.my-timeline .timeline > li {margin-bottom:15px;position:relative;width:100%;float:left;clear:left}
	.my-timeline .timeline > li > .timeline-panel {width:calc(100% - 30px);width:-moz-calc(100% - 30px);width:-webkit-calc(100% - 30px)}
	.my-timeline .timeline > li > .timeline-badge {left:-2px;margin-left:0;top:16px}
	.my-timeline .timeline > li > .timeline-panel {float:right}
	.my-timeline .timeline > li > .timeline-panel:before {top:30px;right:-8px;border-top:8px solid transparent;border-left:8px solid #ccc;border-bottom:8px solid transparent}
	.my-timeline .timeline > li > .timeline-panel:after {top:31px;right:-7px;border-top:7px solid transparent;border-left:7px solid #fff;border-bottom:7px solid transparent}
	.my-timeline .timeline > li > .timeline-panel:before {border-left-width:0;border-right-width:8px;left:-8px;right:auto}
	.my-timeline .timeline > li > .timeline-panel:after {border-left-width:0;border-right-width:7px;left:-7px;right:auto}
	.my-timeline .timeline > li.timeline-inverted{float:left; clear:left;margin-top:15px;margin-bottom:30px}
	.my-timeline .timeline > li.timeline-inverted > .timeline-badge{left:-2px}
}
@media (min-width: 768px) {
	.my-timeline-modal {width:750px;margin:10px auto}
	.my-timeline-modal .modal-header, .my-timeline-modal .modal-body, .my-timeline-modal .modal-footer {padding:10px 20px}
}
@media (min-width: 992px) {
	.my-timeline-modal {width:970px}
}
@media (min-width: 1200px) {
	.my-timeline-modal {width:1170px}
}
#infscr-loading {text-align:center;z-index:100;position:absolute;left:50%;bottom:0;width:200px;margin-left:-100px;padding:10px;background:#000;opacity:0.6;color:#fff}
.my-timeline .view-infinite-more .btn-e-lg {padding:10px 50px;font-size:17px;font-weight:bold;border:1px solid #959595}
</style>

<div class="my-timeline">
	<div class="cont-text-bg margin-bottom-30">
	    <p class="bg-primary rounded">내 타임라인</p>
	</div>
	<!--{? timeline}-->
	<ul class="timeline">
		<!--{@ list}-->
		<li class="{? .key_%2 == 1}timeline-inverted{/}">
			<div class="timeline-badge"><i class="fa fa-dot-circle-o"></i></div>
			<div class="timeline-panel">
				<div class="timeline-heading">
					<!--{? .img_src}-->
					<div class="timeline-img">
                        <a href="{.href}" {? !C.G5_IS_MOBILE}onclick="timeline_modal(this.href); return false;"{:}target="_blank"{/}><img class="img-responsive" src="{.img_src}"></a>
					</div>
					<!--{/}-->
				</div>
				<a href="{.href}" {? !C.G5_IS_MOBILE}onclick="timeline_modal(this.href); return false;"{:}target="_blank"{/}>
					<div class="timeline-top">
						<strong class="color-blue"><i class="fa fa-clock-o"></i> <u>{eb->date_time('Y.m.d - H:i',.datetime)}</u></strong>
						<span class="pull-right color-grey"><i class="fa fa-info-circle"> <!--{? .wr_id == .wr_parent}-->포스팅<!--{:}-->댓글<!--{/}--></i></span>
						<div class="clearfix"></div>
					</div>
					<div class="timeline-body">
						<!--{? .wr_id == .wr_parent}-->
						<h5 class="ellipsis margin-bottom-15">{=get_text(.wr_subject)}</h5>
						<!--{/}-->
						<p class="color-grey font-size-12">
							<!--{? .wr_id !== .wr_parent}-->
							<i class="fa fa-comments-o color-black font-size-20 margin-right-10"></i>
							<!--{/}-->
							{=conv_subject(.wr_content,100,'…')}
						</p>
						<!--{@ video}-->
						<p>{..value_}</p>
						<!--{/}-->
						<!--{@ sound}-->
						<p>{..value_}</p>
						<!--{/}-->
						<div class="clearfix"></div>
					</div>
				</a>
				<div class="timeline-footer">
					<!--{? .wr_id == .wr_parent}-->
					<span class="pull-left"><i class="fa fa-eye margin-right-5"></i>{.wr_hit}<i class="fa fa-comments-o margin-right-5 margin-left-10"></i>{=number_format(.wr_comment)}</span>
					<!--{/}-->
					<span class="pull-right color-black">{.bo_info.gr_name} / {.bo_info.bo_name}</span>
					<div class="clearfix"></div>
				</div>
			</div>
		</li>
		<!--{/}-->
		<li class="clearfix float-none"></li>
	</ul>
	<div id="infinite_pagination">
		<a class="next" href="{C.G5_URL}/mypage/?t=timeline&page={page+1}"></a>
	</div>
	<div class="view-infinite-more text-center margin-top-30 margin-bottom-20">
		<a id="my-timeline-more" href="#" class="btn btn-default btn-e-lg">더 보기 <i class="fa fa-arrow-circle-o-down"></i></a>
	</div>
	<!--{:}-->
	<div class="text-center margin-top-30 margin-bottom-30 color-grey font-size-13">
		<i class="fa fa-exclamation-circle"></i> 타임라인에 표시할 게시글 활동이 없습니다.
	</div>
	<!--{/}-->
	<!--{* 타임라인 상세보기 모달 시작 *}-->
	<div class="modal fade timeline-iframe-modal" tabindex="-1" role="dialog" aria-hidden="true">
	    <div class="modal-dialog my-timeline-modal">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
	                <h4 class="modal-title"><strong><i class="fa fa-search"></i> 나의 타임라인 상세보기</strong></h4>
	            </div>
	            <div class="modal-body">
	                <iframe id="timeline-iframe" width="100%" frameborder="0"></iframe>
	            </div>
	            <div class="modal-footer">
	                <button data-dismiss="modal" class="btn-e btn-e-lg btn-e-dark" type="button"><i class="fa fa-close"></i> 닫기</button>
	            </div>
	        </div>
	    </div>
	</div>
	<!--{* 타임라인 상세보기 모달 끝 *}-->
</div>

<script src="../../../plugins/masonry/jquery.masonry.min.js"></script>
<script src="../../../plugins/infinite-scroll/jquery.infinitescroll.min.js"></script>
<script src="../../../plugins/slick/slick.min.js"></script>
<script>
$('.timeline-img').slick({
	infinite: true,
	autoplay: true,
	autoplaySpeed: 5000,
	arrows: false
});

function timeline_modal(href) {
	$('.timeline-iframe-modal').modal('show').on('hidden.bs.modal', function () {
		$("#timeline-iframe").attr("src", "");
		$('html').css({overflow: ''});
	});
	$('.timeline-iframe-modal').modal('show').on('shown.bs.modal', function () {
		$("#timeline-iframe").attr("src", href);
		$('#timeline-iframe').height(parseInt($(window).height() * 0.85));
		$('html').css({overflow: 'hidden'});
	});
	return false;
}

$(function(){
    var $container = $('.my-timeline .timeline');
	$container.infinitescroll({
		navSelector  : "#infinite_pagination",
		nextSelector : "#infinite_pagination .next",
		itemSelector : ".my-timeline .timeline li",
		loading: {
			finishedMsg: 'END',
			img: '../../../image/loading.gif'
		}
	},
	function( newElements ) {
		var $newElems = $( newElements ).css({ opacity: 0 });
		$newElems.imagesLoaded(function(){
			$newElems.animate({ opacity: 1 });
		});
	});
	$(window).unbind('.infscr');
	$('#my-timeline-more').click(function(){
		$container.infinitescroll('retrieve');
		$('#infinite_pagination').show();
		return false;
	});
});
</script>